# Hackintosh
This is a repo where I store my EFI and steps to get my Ryzen Hackintosh working properly.

## Hardware Used
Processor: AMD Ryzen 5 2600  
Mainboard: AsRock B450M Steel Legend  
Memory: Corsair Vengeance (2x8GB) DDR4-3200  
Storage: ADATA XPG SX8200 Pro (512GB) M.2 NVMe (OSX)  
Graphics Card: Sapphire Radeon R9 370 4GB  

## Software Version
![Working Proof](https://i.ibb.co/gmnrjrr/Screenshot-2020-10-20-at-12-55-36-AM.png)  
MacOS Catalina 10.15.7 (Build 19H2)

## Reference Links
### GPU Spoofing
[OpenCore GPU Spoof](https://dortania.github.io/Getting-Started-With-ACPI/Universal/spoof.html)  
[Patch SSDT-GPU-SPOOF](https://www.reddit.com/r/hackintosh/comments/g3tsgn/i_cant_spoof_my_r9_270_and_cant_disable_my_rtx/)  
[Inject Kexts with Hackintool](https://www.tonymacx86.com/threads/guide-installing-3rd-party-kexts-el-capitan-sierra-high-sierra-mojave-catalina.268964/)  
[Bypass CSR Filesystem](https://apple.stackexchange.com/questions/388469/unable-to-mount-read-write-in-os-catalina-10-15-4-in-single-user-mode)  
[Compiling and Decompiling ACPI Tables](https://dortania.github.io/Getting-Started-With-ACPI/Manual/compile.html#macos)  

### Preparing OpenCore USB
[Making OC Installer in Windows](https://dortania.github.io/OpenCore-Install-Guide/installer-guide/winblows-install.html)  
[Organizing OpenCore EFI](https://dortania.github.io/OpenCore-Install-Guide/installer-guide/opencore-efi.html)  
[Gathering Required Files](https://dortania.github.io/OpenCore-Install-Guide/ktext.html)  
[Dumping DSDT](https://dortania.github.io/Getting-Started-With-ACPI/Manual/dump.html#from-windows)  
[Modifying config.plist](https://dortania.github.io/OpenCore-Install-Guide/AMD/zen.html#starting-point)  

## Steps
1. Prepare the USB
- Download and load recovery to USB using gibMacOS
- Put ACPI, Drivers and Kexts into EFI
- Configure config.plist
```
boot-args: -v keepsyms=1 debug=0x100 alcid=1 npci=0x2000
```
- Patch config.plist with GenSMBIOS
- Verify serial generated by GenSMBIOS is not in use
- Pass OpenCore Sanity Check

2. Configure BIOS
- Load UEFI Defaults
- OC Tweaker > Load XMP Setting > XMP 2.2 profile (for DDR4-3200)
- Advance > Super IO Configuration > Serial Port > Disable
- Boot > CSM > Disabled

3. Install macOS
- Format a drive as APFS with GUID Partitioning Table
- Proceed with installation

4. GPU Spoofing (FakeID)
- Identify PCI ID & ACPI Path 👉🏼 [OpenCore GPU Spoof](https://dortania.github.io/Getting-Started-With-ACPI/Universal/spoof.html)
- Patch SSDT-GPU-SPOOF.dsl and compile it to SSDT-GPU-SPOOF.aml 👉🏼 [Patch SSDT-GPU-SPOOF](https://www.reddit.com/r/hackintosh/comments/g3tsgn/i_cant_spoof_my_r9_270_and_cant_disable_my_rtx/)
```
~~External (_SB_.PCI0, DeviceObj)~~
~~External (_SB_.PCI0.PEG0.PEGP, DeviceObj)~~
```
Modify this 2 lines into 👇🏼
```
External (_SB_.PCI0.PEG0.PEGP, DeviceObj)
Scope (\_SB.PCI0.PEG0.PEGP).
```
- Place it into EFI/OC/ACPI
- Update config.plist (OC Snapshot)

5. Patch AMD Kexts
- Disable CSR Proctection from Recovery Mode with `csrutil enable --without fs` and reboot 👉🏼 [Bypass CSR Filesystem](https://apple.stackexchange.com/questions/388469/unable-to-mount-read-write-in-os-catalina-10-15-4-in-single-user-mode)
- Copy **AMD7000Controller.kext, AMDRadeonX4000.kext and, AMDRadeonX4000HWServices.kext** from /Systems/Library/Extensions 
- Modify each *Info.plist*, replace **0x68191002** with **0x68111002** 
- Patch kexts with Hackintool 👉🏼 [Inject Kexts with Hackintool](https://www.tonymacx86.com/threads/guide-installing-3rd-party-kexts-el-capitan-sierra-high-sierra-mojave-catalina.268964/)
- Re-engage CSR Proctection with `csrutil enable` from Recovery Mode
